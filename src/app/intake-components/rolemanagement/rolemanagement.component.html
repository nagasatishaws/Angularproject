<!--
  /**
* Author - Biplab
* Version - 1.0
* Create date - 25 sep 2019
*/
-->


<div class="row d-flex justify-content-end">
  <button mat-mini-fab
          color="primary"
          (click)="addrole()"
          [disabled]="!create">
    <mat-icon>add</mat-icon>
  </button>
</div>

<!-- <mat-card class="mt-3"> -->
<div class="mt-3">
  <mat-accordion displayMode="flat"
                 multi
                 class="mat-table">
    <div *ngIf="appRoles.length === 0">No Roles to display</div>
    <mat-expansion-panel class="mt-2"
                         *ngFor="let rolelists of appRoles; let i = index">
      <mat-expansion-panel-header>
        <mat-panel-title>
          <span>
            <!-- <span class="fa fa-user mr-2" aria-hidden="true"></span> -->
            <i class="i-Business-Man mr-2"
               style="font-size:25px;"></i>
            {{ rolelists.clientName }}
          </span>
        </mat-panel-title>
        <!-- <mat-icon
            class="material-icons-outlined ml-auto mr-2 mt-2"
            (click)="deleteRole(rolelists.role, i)"
            title="Delete"
            style="cursor: pointer;color: #777777;"
            >delete
          </mat-icon> -->
      </mat-expansion-panel-header>
      <div class="row"
           *ngFor="let rolelistss of rolelists.roleList; let l = index">
        <div class="col-11">
          <mat-accordion displayMode="flat"
                         multi
                         class="mat-table mt-2">
            <mat-expansion-panel class="mt-2">
              <mat-expansion-panel-header>
                <mat-panel-title>
                  <span>
                    <!-- <span class="fa fa-user mr-2" aria-hidden="true"></span> -->
                    <i class="i-Business-Man mr-2"
                       style="font-size:25px;"></i>
                    {{ rolelistss.roleDisplayName }}
                  </span>
                </mat-panel-title>
              </mat-expansion-panel-header>
              <div class="row"
                   *ngFor="let access of rolelistss.permissions; let j = index">
                <span class="col-4">
                  <i class="mr-2"
                     style="font-size:20px;"></i>
                  {{ access.moduleName }}</span>
                <span class="col-2"
                      *ngFor="
                let privilages of access.privilege | keyvalue;
                let k = index
              ">
                  <label class="checkbox checkbox-primary">
                    <input type="checkbox"
                           [(ngModel)]="privilages.value"
                           (change)="
                    clickPermissions(
                      rolelists.clientId,
                      rolelistss.roleName,
                      rolelistss.roleId,
                      rolelistss.roleDisplayName,
                      privilages,
                      access.privilege,
                      rolelistss.permissions,
                      j,
                      i,
                      l
                    )
                  " />
                    <span *ngIf="k === 0">Create</span>
                    <span *ngIf="k === 1">Read</span>
                    <span *ngIf="k === 2">Update</span>
                    <span *ngIf="k === 3">Delete</span>
                    <span class="checkmark"></span>
                  </label>
                </span>
              </div>
              <div class="d-flex justify-content-end mt-3">
                <button ngbAutofocus
                        class="btn btn-primary btn-rounded mr-2"
                        tabindex="-1"
                        (click)="modifyAccess()"
                        [disabled]="!update || this.modifyObject._id !== rolelistss._id">
                  Modify
                </button>

                <!-- <button mat-raised-button class="ml-3" tabindex="-1">Cancel</button> -->
              </div>
            </mat-expansion-panel>
          </mat-accordion>
        </div>
        <div class="col-1">
          <span (click)="editrole(i, l)"
                class="c-p mt-3 far fa-2x fa-edit"></span>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
</div>
<!-- </mat-card> -->
